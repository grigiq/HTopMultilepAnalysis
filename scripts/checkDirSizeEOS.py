# Get total size of files in a directory on EOS
#
# 1. eos dirlist /eos/escience/UniTexas/HSG8/multileptons_ntuple_run2/.../ >> checkDirSizeEOS.py
# 2. Edit the file to wrap the file sizes in a python list
# 3. Do a trivial loop to get the total size!

# MM MC, v7
#
sizelist = [ 472905181,282163869,490035345,357290140,629826723,4621715354,11560839,12772894,14337211,81989017,731597580,880989083,342508508,100268631,4826892,5588607,281638957,281552302,205871280,251826710,5395058,103012160,2322546,14810386647,1461614355,1565086104,892369458]

# data, v7
#
#sizelist = [236453896,387139713,21109255,123789447,242874545,294299376,19204585,44215316,179539109,21079991,589747876,534047838,258639831,1416621950,188703370,434898506,817961910,1292107976,7815119,1606986036,1766802228,158226722,1191621747,717160659,24676278,1072665388,1562573303,2126128792,2239182243,192621258,1651144725,1400992932,189642386,309367910,588856911,3424650498,987176655,170562437,3015954670,2871007928,813661974,289665914,1012198518,23598151,535020559,1338012294,2897695631, 284560975,595717663,2033539191,79410027,2290972637,1253547559, 662837718, 310062459,4911732635, 525444622,2976713660, 863634288, 231807120,4161347649,5262497852,1288325830, 805522950,2235404181]

UNITS = "GB"
SIZE = 0
unit_dict = { "MB" : 1e6, "GB" : 1e9 }

for item in sizelist:
    SIZE += (item/unit_dict[UNITS])
print("Total size : {0} [{1}]".format(SIZE,UNITS))
